---
title: "Climbing Insights"
author: Ian McDonald
output: html_notebook
---
#Intro
Welcome to my data science project. The data I chose to examine for this was a dataset that was scraped from 8a.nu. This is a popular website used by rock climbers. 8a.nu offers a feature that allows users to log the climbs that they have completed. Additionally there is user data included that has information about the climbers who logged these climbs. As a rock climber myself, this data interested me as I hoped to learn a little bit more about climbers, but also learn more about climbing areas and individual climbs.

# Setup

installing packages needed
```{r}
install.packages("tidyverse")
install.packages("RSQLite")
install.packages("RColorBrewer")
install.packages("ggplot")
```

loading libraries that we installed
```{r}
library("tidyverse")
library("RSQLite")
library(ggplot2)
library("RColorBrewer")
```

Creating a connection to the database we will be using. This database houses all of the user entered data the was taken from 8a.nu. After creating the connections we then we run commmands to display all of the individual column names so we can identify the data stored in each table.
```{r}
con <- dbConnect(RSQLite::SQLite(), "database.sqlite")

dbListTables(con)
dbListFields(con, "ascent")
dbListFields(con, "grade")
dbListFields(con, "method")
dbListFields(con, "user")

```
#Time to Clean and Tidy Data
We are first going to grab all data from each table and store them in a dataframe
```{r}

ascents <- dbGetQuery(con, "SELECT * FROM ASCENT;")
grades <- dbGetQuery(con, "SELECT * FROM GRADE");
methods <- dbGetQuery(con, "SELECT * FROM METHOD;")
users <- dbGetQuery(con, "SELECT * FROM USER;")

```

Cleaning user dataframe. First we take all values in the height and weight columns and replace them with N/A value
```{r}
users[, 7:8][users[,7:8]==0] <- NA
userBodyInfo <- dplyr::tibble(id=users$id, height=users$height, weight=users$weight)
```
#Early Exploration

Plot number of climbs logged at each different grade as a bar chart
```{r}
plot <- ggplot(ascents, aes(x=grade_id)) + geom_bar() + xlab("Grade") + ylab("Number of Logged Climbs")
plot
```


```{r}
res <- dbGetQuery(con, "SELECT country, count(id) from user group by country order by count(id) desc limit 10;")


p<-ggplot(data=res, aes(x=reorder(country, -res$`count(id)`), y=res$`count(id)`)) + geom_bar(stat="identity") + xlab("Country of Residence") + ylab("Number of Climbers") + theme
p
```
